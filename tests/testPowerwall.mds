# Licensed under the MIT License
# https://github.com/craigahobbs/tespo/blob/main/LICENSE

include '../powerwall.mds'


function testPowerwallSimulate_zeroHome_zeroSolar()
    unittestDeepEquals( \
        powerwallSimulate(objectNew( \
            'name', 'Powerwall Scenario', \
            'batteryCapacity', 40, \
            'backupPercent', 20, \
            'chargeRatio', 0.95, \
            'dischargeRatio', 0.95, \
            'data', arrayNew( \
                objectNew( \
                    powerwallFieldDate, datetimeNew(2023, 4, 18, 4, 35), \
                    powerwallFieldHome, 0, powerwallFieldSolar, 0, powerwallFieldBatteryPercent, 50 \
                ), \
                objectNew( \
                    powerwallFieldDate, datetimeNew(2023, 4, 18, 4, 40), \
                    powerwallFieldHome, 0, powerwallFieldSolar, 0, powerwallFieldBatteryPercent, 50 \
                ) \
            ) \
        )), \
        arrayNew( \
            objectNew( \
                powerwallFieldDate, datetimeNew(2023, 4, 18, 4, 35), \
                powerwallFieldHome, 0, powerwallFieldSolar, 0, \
                powerwallFieldGrid, 0, powerwallFieldPowerwall, 0, powerwallFieldBatteryPercent, 50 \
            ), \
            objectNew( \
                powerwallFieldDate, datetimeNew(2023, 4, 18, 4, 40), \
                powerwallFieldHome, 0, powerwallFieldSolar, 0, \
                powerwallFieldGrid, 0, powerwallFieldPowerwall, 0, powerwallFieldBatteryPercent, 50 \
            ) \
        ) \
    )
endfunction
unittestRunTest('testPowerwallSimulate_zeroHome_zeroSolar')
